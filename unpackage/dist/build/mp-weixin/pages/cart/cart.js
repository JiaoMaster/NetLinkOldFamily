(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cart/cart"],{"15cb":function(e,t,n){"use strict";(function(e){n("58fa");o(n("66fd"));var t=o(n("f5e4"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"15d9":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n("66fd");function o(e){return a(e)||u(e)||i(e)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function u(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function a(e){if(Array.isArray(e))return s(e)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var c={data:function(){return{show:!0,allchecked:!1,checked:!1,goods:[],order:{},token:"",amount:"",payArr:[],payType:1,page:2,id:"",list:["未决定","兑换历史"],current:0,upshow:!1,pHeight:"",userId:"",adId:"",adList:[]}},onReachBottom:function(){1!=this.current&&this.loadmore()},onLoad:function(){var t=this;e.getSystemInfo({success:function(e){console.log(e.screenHeight),t.pHeight=e.screenHeight-250}})},methods:{toLogin:function(){e.navigateTo({url:"/pages/user/login"})},rChange:function(e){this.adId=e,console.log(this.adId)},color:function(e){return 0==e?"warning":1==e?"error":"success"},close:function(){this.upshow=!1},sectionChange:function(e){console.log(e),this.current=e,this.reload()},scrolltolower:function(){console.log("触底"),this.loadmore()},loadmore:function(){var t=this;e.request({url:"https://link.netlinkold.cn/api/user/get_user_info",method:"POST",header:{Authorization:"Bearer "+t.token},success:function(n){t.id=n.data.info.userid,e.request({url:"https://link.netlinkold.cn/api/order/GetList/"+t.page+"/10/"+t.id,method:"POST",header:{Authorization:"Bearer "+t.token},data:{amount:t.amount,page:t.page,id:t.id,now:t.current},success:function(e){var n;t.page+=1,t.order=(n=t.order).concat.apply(n,o(e.data.orderList));var r=t.order;t.goods=r.filter((function(e){return 0==e.ifApply})),t.goods.map((function(e){e.flag=!1})),t.show=!0},fail:function(e){console.log(e.data)}})}})},change:function(e){console.log(e)},Apply:function(e){return 0==e?"待查看":1==e?"不同意":"已同意"},selected:function(e){if(e.flag=!e.flag,e.flag){var t=this.goods.forEach((function(e){return!0===e.flag}));this.allchecked=!!t}else this.allchecked=!1},selectgoods:function(){var e=this;this.allchecked=!this.allchecked,this.allchecked?this.goods.map((function(t){e.checked=!0,t.flag=!0})):(this.checked=!1,this.goods.map((function(e){e.flag=!1})))},reduce:function(t){var n=t.number;n>1?n-=1:(n=1)&&e.showToast({title:"该宝贝不能减少了哟~"}),t.number=n},add:function(e){var t=e.number;e.number=t+1},unApply:function(){},Pay:function(){0!=this.totalNum?(this.upshow=!0,this.getAd()):e.showToast({title:"一件还没选呢！！！",icon:"error",duration:500})},firm:function(){var t=this,n=this.goods.filter((function(e){return 1==e.flag})),o=Number(this.payType);e.request({url:"https://link.netlinkold.cn/api/order/PayAllOrder/"+t.adId,method:"POST",header:{Authorization:"Bearer "+t.token},data:{orders:n,payType:o},success:function(n){console.log(n),404==n.data.code?e.showToast({title:"支付失败",icon:"error",duration:500}):(e.showToast({title:"支付成功，在历史单查看",duration:500}),t.reload())},fail:function(e){console.log(e)}}),this.upshow=!1},getAd:function(){var t=this;e.request({url:"https://link.netlinkold.cn/api/address/getList/"+t.userId,method:"POST",header:{Authorization:"Bearer "+t.token},data:{},success:function(e){t.adList=e.data.addressList,console.log(t.adList),t.adId=e.data.addressList[0].id},fail:function(e){console.log(e)}})},toOrder:function(t){e.navigateTo({url:"/pages/cart/orderDetail?id="+t})},reload:function(){var t=this;t.page=2,this.allchecked=!1,this.checked=!1,e.getStorage({key:"token",success:function(n){t.token=n.data,console.log(n.data),e.request({url:"https://link.netlinkold.cn/api/user/get_user_info",method:"POST",header:{Authorization:"Bearer "+t.token},success:function(n){console.log(n.data),t.id=n.data.info.userid,e.request({url:"https://link.netlinkold.cn/api/order/GetList/1/10/"+t.id,method:"POST",header:{Authorization:"Bearer "+t.token},data:{amount:t.amount,page:t.page,id:t.id,now:t.current},success:function(e){console.log(e.data),console.log(t.id),t.order=e.data.orderList;var n=e.data.orderList;t.goods=n.filter((function(e){return 0==e.ifApply})),t.goods.map((function(e){e.flag=!1})),t.show=!0},fail:function(e){console.log(e.data)}})}})}})}},computed:{totalNum:function(){var e=0;return this.goods.map((function(t){t.flag?e+=t.number:e+=0})),e},totalPrice:function(){var e=0;return this.goods.map((function(t){t.flag?e+=t.number*t.amount:e+=0})),e}},mounted:function(){e.getStorage({key:"token",success:function(t){""==t.data&&e.showToast({title:"未登录，请登录",icon:"error",duration:1e3})},fail:function(){e.showToast({title:"未登录，请登录",icon:"error",duration:1e3})}})},onPullDownRefresh:function(){var t=this;t.page=2,this.allchecked=!1,this.checked=!1,e.getStorage({key:"token",success:function(n){t.token=n.data,console.log(n.data),e.request({url:"https://link.netlinkold.cn/api/user/get_user_info",method:"POST",header:{Authorization:"Bearer "+t.token},success:function(n){console.log(n.data),t.id=n.data.info.userid,e.request({url:"https://link.netlinkold.cn/api/order/GetList/1/10/"+t.id,method:"POST",header:{Authorization:"Bearer "+t.token},data:{amount:t.amount,page:t.page,id:t.id,now:t.current},success:function(e){console.log(e.data),console.log(t.id),t.order=e.data.orderList;var n=e.data.orderList;t.goods=n.filter((function(e){return 0==e.ifApply})),t.goods.map((function(e){e.flag=!1})),t.show=!0},fail:function(e){console.log(e.data)}})}})}}),e.stopPullDownRefresh()},onShow:function(){var t=this;e.getStorage({key:"UserId",success:function(e){t.userId=e.data}}),t.page=2,this.allchecked=!1,this.checked=!1,e.getStorage({key:"token",success:function(n){if(t.token=n.data,""==t.token)return t.order=null,void(t.goods=null);e.request({url:"https://link.netlinkold.cn/api/user/get_user_info",method:"POST",header:{Authorization:"Bearer "+t.token},success:function(n){t.id=n.data.info.userid,e.request({url:"https://link.netlinkold.cn/api/order/GetList/1/10/"+t.id,method:"POST",header:{Authorization:"Bearer "+t.token},data:{amount:t.amount,page:t.page,id:t.id,now:t.current},success:function(e){if(0==e.data.orderList.length)return t.order=null,void(t.goods=null);t.order=e.data.orderList;var n=e.data.orderList;t.goods=n.filter((function(e){return 0==e.ifApply})),t.goods.map((function(e){e.flag=!1})),t.show=!0},fail:function(e){console.log(e.data)}})}})},fail:function(){""!=this.token||e.navigateTo({url:"/pages/user/login"})}})}};t.default=c}).call(this,n("543d")["default"])},"3d4d":function(e,t,n){},4430:function(e,t,n){"use strict";var o=n("3d4d"),r=n.n(o);r.a},"99e8":function(e,t,n){"use strict";n.r(t);var o=n("15d9"),r=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},d0af:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={uSticky:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-sticky/u-sticky")]).then(n.bind(null,"82eb"))},uSubsection:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-subsection/u-subsection")]).then(n.bind(null,"c0a7"))},uEmpty:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-empty/u-empty")]).then(n.bind(null,"2f7b"))},uList:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-list/u-list")]).then(n.bind(null,"6b22"))},uListItem:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-list-item/u-list-item")]).then(n.bind(null,"3fbb"))},uCell:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-cell/u-cell")]).then(n.bind(null,"69aa"))},uTag:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-tag/u-tag")]).then(n.bind(null,"c30c"))},uAvatar:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-avatar/u-avatar")]).then(n.bind(null,"bdcd"))},uPopup:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(n.bind(null,"579d"))},uRadioGroup:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-radio-group/u-radio-group")]).then(n.bind(null,"7dc2"))},uRadio:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-radio/u-radio")]).then(n.bind(null,"b20d"))},uButton:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-button/u-button")]).then(n.bind(null,"f73a"))}},r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.__map(e.order,(function(t,n){var o=e.__get_orig(t),r=e.Apply(t.ifApply),i=e.color(t.ifApply);return{$orig:o,m0:r,m1:i}})));e.$mp.data=Object.assign({},{$root:{l0:n}})},i=[]},f5e4:function(e,t,n){"use strict";n.r(t);var o=n("d0af"),r=n("99e8");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("4430");var u,a=n("f0c5"),s=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);t["default"]=s.exports}},[["15cb","common/runtime","common/vendor"]]]);